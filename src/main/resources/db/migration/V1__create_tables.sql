-- 1. TABELA APLICATIVOS
CREATE TABLE APLICATIVOS (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY,
    NM_APLICATIVO VARCHAR(255),
    DS_APLICATIVO VARCHAR(255),
    DS_URL VARCHAR(255),
    NM_MODULO VARCHAR(255),
    MODULO_EXPOSTO VARCHAR(255),
    DS_ROTA VARCHAR(255),
    FL_ATIVO VARCHAR(1),
    CRIADO_EM TIMESTAMP NOT NULL,
    ATUALIZADO_EM TIMESTAMP NOT NULL,
    CONSTRAINT PK_APLICATIVOS PRIMARY KEY (id)
);

-- 2. TABELA AUTH_PERMISSAO
CREATE TABLE AUTH_PERMISSAO (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY,
    NM_PERMISSAO VARCHAR(100) NOT NULL,
    CONSTRAINT PK_AUTH_PERMISSAO PRIMARY KEY (id),
    CONSTRAINT UK_NM_PERMISSAO UNIQUE (NM_PERMISSAO)
);

-- 3. TABELA AUTH_PERFIL
CREATE TABLE AUTH_PERFIL (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY,
    NM_PERFIL VARCHAR(255) NOT NULL,
    CONSTRAINT PK_AUTH_PERFIL PRIMARY KEY (id)
);

-- 4. TABELA AUTH_USUARIO
CREATE TABLE AUTH_USUARIO (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY,
    DS_LOGIN VARCHAR(100) NOT NULL,
    DS_SENHA VARCHAR(255) NOT NULL,
    NM_USUARIO VARCHAR(255) NOT NULL,
    FL_ATIVO VARCHAR(1) NOT NULL,
    DS_EMAIL VARCHAR(255),
    CRIADO_EM TIMESTAMP,
    ATUALIZADO_EM TIMESTAMP,
    CONSTRAINT PK_AUTH_USUARIO PRIMARY KEY (ID),
    CONSTRAINT UK_DS_LOGIN UNIQUE (DS_LOGIN)
);

-- 5. TABELA ASSOCIATIVA: AUTH_PERFIL_PERMISSAO (ManyToMany Perfil <-> Permiss√£o)
CREATE TABLE AUTH_PERFIL_PERMISSAO (
    AUTH_PERFIL_ID BIGINT NOT NULL,
    AUTH_PERMISSAO_ID BIGINT NOT NULL,
    PRIMARY KEY (AUTH_PERFIL_ID, AUTH_PERMISSAO_ID),
    CONSTRAINT FK_PERFIL FOREIGN KEY (AUTH_PERFIL_ID) REFERENCES AUTH_PERFIL(id),
    CONSTRAINT FK_PERMISSAO FOREIGN KEY (AUTH_PERMISSAO_ID) REFERENCES AUTH_PERMISSAO(id)
);

-- 6. TABELA ASSOCIATIVA: AUTH_USUARIO_PERFIL (ManyToMany Usuario <-> Perfil)
CREATE TABLE AUTH_USUARIO_PERFIL (
    AUTH_USUARIO_ID BIGINT NOT NULL,
    AUTH_PERFIL_ID BIGINT NOT NULL,
    CONSTRAINT PK_USUARIO_PERFIL PRIMARY KEY (AUTH_USUARIO_ID, AUTH_PERFIL_ID),
    CONSTRAINT FK_USU_PER_USUARIO FOREIGN KEY (AUTH_USUARIO_ID) REFERENCES AUTH_USUARIO(ID),
    CONSTRAINT FK_USU_PER_PERFIL FOREIGN KEY (AUTH_PERFIL_ID) REFERENCES AUTH_PERFIL(id)
);
